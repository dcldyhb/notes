---
title: 自动控制原理B笔记
category:
  - 本科课程
  - 电路
tags:
  - 自动控制原理
  - 课程笔记
math: true
date: 2025-9-15 18:00
---

# 自动控制原理 B

## 导论

### 概述

自动控制的意义

- 提高了劳动生产率
- 提高控制的准确性
- 可用于某些人们不能直接参与工作的场合

判断一个系统是否为自动控制系统的标准：控制过程脱离人的控制

但是，自动控制系统中仍然有人参与，并非脱离人的设置

### 自动控制理论的发展

#### 胚芽期（1945 年以前）

- 18 世纪以后，蒸汽机的使用提出了调速稳定等问题
  - 1765 年，俄国人波尔祖诺夫发明了锅炉水位调节器
  - 1784 年，英国人瓦特发明了调速器，蒸汽机离心式调速器
  - 1877 年，产生了古氏判据和劳斯稳定判据
- 19 世纪前半叶，动力使用了发电机、电动机
  - 促进了水利、水电站的遥控和程控的发展以及电压、电流的自动调节技术的发展
- 19 世纪末，20 世纪初，使用内燃机
  - 促进了飞机、汽车、船舶、机器制造业和石油工业的发展，产生了伺服控制和过程控制
- 20 世纪初第二次世界大战，军事工业发展很快
  - 飞机、雷达、火炮上的伺服机构，总结了自动调节技术及反馈放大器技术，搭起了经典控制理论的架子，但还没有形成学科

#### 经典控制理论

- 1945 年
  美国人 Bold 网络分析与放大器的设计
  奠定了控制理论的基础
- 50 年代
  趋于成熟
- 研究对象
  单输入、单输出系统
- 描述方法
  传递函数
- 研究方法
  频率法、根轨迹法
- 研究内容
  系统稳定性的代数和几何判据以及校正网络等
- 举例
  - 调节电压改变电机的速度
  - 调整方向盘改变汽车的运动轨迹

#### 现代控制理论

- 空间技术的发展提出了许多复杂控制问题
- 用于导弹、人造卫星和宇宙飞船上
- Kalmann 控制系统一般理论
  奠定了现代控制理论的基础
- 研究对象
  - 线性、非线性、定常、时变系统
  - 多输入、多输出
- 描述方法
  - 向量空间（状态空间）
- 研究方法
  - 状态空间法

#### 大系统理论

- 一种过程控制与信息处理相结合的动态系统工程理论
- 研究对象
  - 规模庞大、结构复杂、功能综合、目标多样、因素众多
  - 多输入、多输出、多干扰、多变量的系统
- 举例
  - 人体大系统
  - 三峡水利枢纽

#### 智能控制理论

- 研究对象
  模糊性、不确定性、不完整性、偶然性的系统
- 基础
  人工智能理论
- 指导思想
  依据人的思维方式和处理问题的技巧，解决哪些目前需要人的只能才能解决的问题

### 自动控制系统的分类

#### 信号的传递路径

##### 开环系统

作用信号由输入到输出单方向传递，系统的输出端与输入端不存在反馈回路

优点：

1. 结构简单，成本低廉，不存在稳定性问题
2. 当输入信号和扰动能预先知道时，控制效果较好

缺点：

1. 不具备自动修正能力
2. 系统的元件参数变化以及未来的未知扰动对控制精度影响较大

##### 闭环系统

输出信号通过测量元件反馈到系统的输入端，通过比较、控制来减小系统误差

优点：

1. 具有自动修正被控制量出现偏离的能力
2. 可修正元件参数变化以及外界扰动引起的误差
3. 控制精度高

缺点：

- 被控量可能出现振荡，甚至发散

#### 输入量的特点

##### 恒值控制系统

也叫自动调节系统、自动镇定系统

- 输入
  恒定数值
- 任务
  系统在任何扰动作用下，输出量以一定精度接近给定值

##### 过程控制系统

也叫程序控制系统

- 输入
  已知函数
- 任务
  系统的控制过程按预定的程序进行，要求被控量能迅速准确地复现输入

##### 随动系统

也叫伺服系统

- 输入
  未知函数
- 任务
  控制系统的输出量**跟随**输入信号变化

#### 信号传输的性质

分为连续系统和离散系统

#### 元部件的特性

分为线性系统和非线性系统

### 反馈控制系统的基本组成

![基本组成](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202509152359458.png)

主要有三个部分

1. 输入信号
   系统控制目标的反映，是人的意志的体现
2. 控制系统
   主要完成对有关信号的变换，处理，发出控制量，驱动执行机构完成控制功能
3. 输出信号
   系统的控制结果，反映了被控对象的运行状况

![反馈系统组成部分](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202509160009862.png)

对于其系统来说，有这些部分

- 测量元件
  用来测量被控量的实际值
- 比较元件
  用来产生输入信号和主反馈信号的差值信号
- 放大元件
  把误差信号放大并进行能量形式转换
- 执行元件
  根据控制信号直接对控制对象进行操纵
- 被控对象
  控制系统所要操纵的对象

### 对控制系统的基本要求

1. 稳定性
   - 保证控制系统正常工作的先决条件
     - 输入激励会使系统偏离平衡状态
     - 激励消失后，经过一段过程，系统的状态恢复到平衡状态
   - 线性控制系统的稳定性由系统本身的结构与参数所决定的，与外部条件和初始状态无关
2. 稳态特性
   - 过渡过程结束后，系统的误差值，反映了系统的控制精度
3. 动态特性
   - 过渡过程
     系统状态随时间变化的过程
   - 产生原因
     系统中储能元件的能量不可能突变
   - 基本要求
     时间短、平稳、振荡幅度小

### 常用的典型测试信号

我们在分析和设计系统时，常常需要一个对各种系统进行比较的基准，但是实际系统的输入信号具有不确定性，其函数形式难以使用解析法表示，所以我们用一些简单的测试信号对齐进行测试

系统对典型测试信号的相应与实际输入的相应之间应存在一定的关系，实际信号往往是多种典型测试信号的组合，典型测试信号是简单的时间函数

#### 脉冲信号（Pulse）

1. 宽度（持续时间）为 $h$ 的矩形脉冲信号

   $$
   r(t)=
   \left\{
       \begin{aligned}
       &\frac{1}{h},\quad 0 \leq t \leq h \\
       &0, \quad t<0.t>h
     \end{aligned}
   \right.
   $$

2. 单位冲激信号（单位脉冲信号），这是宽度趋于零的矩形脉冲信号

   $$
   r(t)=\delta(t)=
   \left\{
       \begin{aligned}
       &\infty, \quad t=0 \\
       &0, \quad t\neq 0
       \end{aligned}
   \right.
   $$

   其中

   $$
   \int_{-\infty}^{\infty} \delta(t) \,\mathrm{d}t = 1
   $$

   对单位冲激信号做 Laplace 变换，得到

   $$
   R(s)=\int_{0}^{\infty} \delta(t) e^{-s t} \,\mathrm{d}t=1
   $$

#### 阶跃信号（Step）

1. 标准阶跃信号

   $$
   r(t)=R\cdot u(t)=
   \left\{
       \begin{aligned}
       &R, \quad t \geq 0 \\
       &0, \quad t<0
       \end{aligned}
   \right.
   $$

   其中 $u(t)$ 是单位阶跃信号，$R$ 是阶跃高度
   这表明在 $t=0$ 时，阶跃信号从 0 突然跃变到 $R$，并在 $t>0$ 时保持不变

2. 延时阶跃信号

   $$
    r(t)=R\cdot u(t-\tau)=
    \left\{
        \begin{aligned}
        &R, \quad t \geq \tau \\
        &0, \quad t<\tau
        \end{aligned}
    \right.
   $$

   其中 $\tau$ 是延时时间

对阶跃信号做 Laplace 变换，得到

$$
R(s)=\int_{0}^{\infty} R\cdot u(t) e^{-s t} \,\mathrm{d}t=\frac{R}{s}
$$

如果对单位阶跃信号做 Laplace 变换，得到

$$
R(s)=\int_{0}^{\infty} u(t) e^{-s t} \,\mathrm{d}t=\frac{1}{s}
$$

#### 斜坡信号（Ramp）

也被称为速度信号

$$
r(t)=
\left\{
    \begin{aligned}
    &R\cdot t, \quad t \geq 0 \\
    &0, \quad t<0
    \end{aligned}
\right.
$$

对其做 Laplace 变换，得到

$$
R(s)=\int_{0}^{\infty} R\cdot t e^{-s t} \,\mathrm{d}t=\frac{R}{s^{2}}
$$

#### 抛物线信号（Parabolic）

也称匀加速信号

$$
r(t)=
\left\{
    \begin{aligned}
    &\frac{1}{2}R\cdot t^2, \quad t \geq 0 \\
    &0, \quad t<0
    \end{aligned}
\right.
$$

对其做 Laplace 变换，得到

$$
R(s)=\int_{0}^{\infty} \frac{1}{2}R\cdot t^2 e^{-s t} \,\mathrm{d}t=\frac{R}{s^{3}}
$$

#### 正弦信号

$$
r(t)=R\sin(\omega t+\varphi)
$$

其中

- $R$ 是振幅
- $\omega$ 是振荡角频率
- $\varphi$ 是相位移

#### 谐波信号

$$
r(t)=R\cos(\omega t+\varphi)
$$

#### 指数信号

$$
r(t)=R e^{a t}
$$

## 控制系统的数学模型

### 概述

#### 数学模型的定义

数学模型是定义系统行为的数学表达式，也是系统定量分析和研究的首要条件

##### 狭义定义

是对实际物理系统后的数学抽象

##### 广义定义

揭示控制系统各变量内在联系及关系的解析式或图形表示

##### 分类

- 静态模型
  - 揭示控制系统各变量内在联系及关系的解析式或图形表示
  - 静态模型：在静态条件下，描述变量间关系的代数方程
    - 静态条件：变量各阶导数为零
- 动态模型：用微分方程描述变量在动态过程中的关系

#### 表现形式

##### 数学表示

用于分析研究系统的动态特性

其基本形式有

- 微分方程
- 代数方程
- 逻辑方程

数学表示中的传递函数、频率特性等适用于单输入、单输出系统

状态空间描述：用于多变量系统及最优控制问题

##### 图形表示

用于分析研究系统内部的结构和动态特性

其基本形式有

- 信号流图
- 方块图
- 根轨迹图
- 频率特性图

等

还有在数字计算机上的程序综合

##### 建模原则

要分清主次、合理简化，从而建立适当的数学模型

要根据选定的系统分析方法建立起相关的数学模型

- 时间域：微分方程
- 复数域：传递函数
- 频率域：频率特性

![三种数学模型](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202509232158890.png)

##### 复频域分析法

时域中列出微分方程得到时域的解

复频域中列出代数方程得到复频域的解

微分方程通过 Laplace 变换得到代数方程

代数方程通过 Laplace 逆变换得到微分方程

通过这个我们可以在复频域中分析时域问题，从而解决时域分析法存在的难点

##### 建模方法

###### 数学分析法

我们在知道系统的结构和原理的情况下通过数学分析法建立数学模型

分析元件或者系统的物理化学规律，再通过微分方程求解、分析系统

###### 工程分析法

当我们不知道系统的结构和原理时，我们可以通过工程分析法建立数学模型

对实际系统贾一定形式的输出信号，求取输出的相应

使用传递函数、频率特性对系统进行分析、求解

它比数学分析法更加简单、方便、直观

### 微分方程

#### 建立方法

1. 明确输入量和输出量
2. 应用物理规律列出变量的关系是
3. 划分环节
4. 写出每个环节的微分方程
5. 简化微分方程至只含有输入量和输出量
6. 将微分方程转换为标准形式

#### 标准形式

对于一个线性定常系统，其输入 $r(t)$ 和输出 $c(t)$ 之间的关系通常可以用一个高阶常系数线性微分方程来描述：

$$
a_n\frac{\mathrm{d^n c(t)}}{\mathrm{d}t^{n-1}}+a_{n-1}\frac{\mathrm{d^{n-1}c(t)}}{\mathrm{d}t^{n-1}}+\cdots+a_1\frac{\mathrm{d}c(t)}{\mathrm{d}t}+a_0c(t)=b_m\frac{\mathrm{d^m r(t)}}{\mathrm{d}t^m}+b_{m-1}\frac{\mathrm{d^{m-1}r(t)}}{\mathrm{d}t^{m-1}}+\cdots+b_1\frac{\mathrm{d}r(t)}{\mathrm{d}t}+b_0r(t)
$$

其中

- $c(t)$ 是系统的输出量
- $r(t)$ 是系统的输入量

一般来说 $n\geq m$，因为系统中含有储能元件

### 传递函数

#### 定义

线性定常系统在**初始条件为零**的情况下，输出量的 Laplace 变换 $C(s)$ 和输入量的 Laplace 变换 $R(s)$ 之比，称为系统的**传递函数**

$$
G(s) = \frac{\mathcal{L}[c(t)]}{\mathcal{L}[r(t)]} = \frac{C(s)}{R(s)}
$$

其中

- $G(s)$ 是系统的传递函数
- $C(s)=\mathcal{L}(c(t))$ 是系统输出量的 Laplace 变换
- $R(s)=\mathcal{L}(r(t))$ 是系统输入量的 Laplace 变换

#### 性质

1. **模型描述**：传递函数是系统在复数域中的动态数学模型
2. **固有特性**：它反映了系统输入量和输出量之间的内在关系，其系数均为实数，仅由系统结构参数决定
3. **函数形式**：传递函数是复变量 $s$ 的有理真分式函数，即分子的最高阶次 $m$ 小于或等于分母的最高阶次 $n\ (m\leq n)$
4. **与单位脉冲响应的关系**：系统的单位脉冲响应 $g(t)$ 的 Laplace 变换就是该系统的传递函数 $G(s)$ ，即 $G(s)=\mathcal{L}[g(t)]$

#### 表达形式

| 形式             | 表达式                                                                                                                          | 说明                                           |
| :--------------- | :------------------------------------------------------------------------------------------------------------------------------ | :--------------------------------------------- |
| **微分方程**     | $\displaystyle\sum_{i=0}^{n} a_i\frac{\mathrm{d}^ic(t)}{\mathrm{d}t^i}=\sum_{j=0}^{m}b_j\frac{\mathrm{d}^jr(t)}{\mathrm{d}t^j}$ | 时域模型                                       |
| **标准形式**     | $\displaystyle G(s)=\frac{C(s)}{R(s)}=\frac{b_ms^m+b_{m-1}s^{m-1}+\dots+b_0}{a_ns^n+a_{n-1}s^{n-1}+\dots+a_0}$                  | 多项式形式                                     |
| **时间常数形式** | $\displaystyle G(s)=K\frac{(\tau'_1s+1)(\tau'_2s+1)\cdots}{(\mathcal{T}_1s+1)(\mathcal{T}_2s+1)\cdots}$                         | $K$ 为稳态增益                                 |
| **零极点形式**   | $\displaystyle G(s)=K_r\frac{(s+z_1)(s+z_2)\cdots(s+z_m)}{(s+p_1)(s+p_2)\cdots(s+p_n)}$                                         | $z_i$ 为零点, $p_j$ 为极点, $K_r$ 为根轨迹增益 |

#### 求取方法

#### 微分方程法

1. 列出元件或者系统的微分方程
2. 在零初始条件下对方程进行 Laplace 变换
3. 计算 $\frac{C(s)}{R(s)}$ 即为传递函数

#### 频率特性法

通过实验测定

#### 单位脉冲响应法

测量系统的单位脉冲响应 $g(t)$ ，然后对 $g(t)$ 做 Laplace 变换，得到传递函数

$$
G(s)=\frac{\mathcal{L}[c(t)]}{\mathcal{L}[r(t)]}=\frac{\mathcal{L}[g(t)]}{\mathcal{L}[\delta(t)]}=\mathcal{L}[g(t)]
$$

### 典型环节

典型环节总共有**七种**

- **比例环节**
- **微分环节**
  - **典型微分环节**
  - **一阶微分环节**
  - **二阶微分环节**
- **积分环节**
- **惯性环节**
- **震荡环节**

#### 比例环节

- **特点**：输出量与输入量成正比，无延迟、无失真
- **微分方程**： $c(t)=K\cdot r(t)$
- **传递函数**： $G(s)=K$

#### 微分环节

**特点**：输出量与输入量的变化速度相关

##### 典型微分环节

- **特点**： 输出量与输入量的变化速度成正比
- **微分方程**： $\displaystyle c(t)=K\frac{\mathrm{d}r(t)}{\mathrm{d}t}$
- **传递函数**： $G(s)=K s$

##### 一阶微分环节

- **特点**：输出量与输入量的变化速度成正比，但有一定的延迟
- **微分方程**： $\displaystyle c(t)=T\frac{\mathrm{d}c(t)}{\mathrm{d}t}+r(t)$
- **传递函数**： $G(s)=\frac{1}{Ts+1}$

##### 二阶微分环节

- **特点**：输出量与输入量及其一、二届导数相关
- **微分方程**：$\displaystyle c(t)=T^2\frac{\mathrm{d}^2r(t)}{\mathrm{d}t^2}+2\xi T\frac{\mathrm{d}r(t)}{\mathrm{d}t}+r(t)$
- **传递函数**： $G(s)=T^2s^2+2\zeta Ts+1$

#### 积分环节

- **特点**：输出量的变化速度与输入量成正比
- **微分方程**： $\frac{\mathrm{d}c(t)}{\mathrm{d}t} = K\cdot r(t)$
- **传递函数**： $G(s) =\frac{K}{s}$

#### 惯性环节

- **特点**：对突变的输入，输出不能立即复现，而是按指数规律延迟变化含有一个独立的储能元件
- **微分方程**： $T\frac{\mathrm{d}c(t)}{\mathrm{d}t}+c(t)=K\cdot r(t)$
- **传递函数**： $G(s)=\frac{K}{Ts+1}$

#### 振荡环节（二阶）

- **特点**：当输入信号变化时，两个储能元件能量交换，使输出带有振荡性质
- **微分方程**： $T^2\frac{\mathrm{d}^2c(t)}{\mathrm{d}t^2}+2\zeta T\frac{\mathrm{d}c(t)}{\mathrm{d}t}+c(t)=K\cdot r(t)$
- **传递函数**： $G(s)=\frac{K}{T^2s^2+2\zeta Ts +1}$

### 方块图

方块图（或结构图）是系统数学模型的图解形式，直观地描述了系统中各元件间的关系以及信号的传递过程

#### 基本组成

| 组件                 | 图示                                                                                                    | 说明                                       |
| :------------------- | :------------------------------------------------------------------------------------------------------ | :----------------------------------------- |
| **信号线**           | $\rightarrow$                                                                                           | 带箭头的直线，箭头表示信号的传递方向       |
| **方块（环节）**     | ![环节](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510151542576.png)   | 输入到输出**单向传递**的函数关系           |
| **比较点（求和点）** | ![比较点](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510151543603.png) | 对两个或多个信号进行加减运算，必须量纲相同 |
| **分支点（测量点）** | ![分支点](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510151543538.png) | 表示信号从此处引出，引出后原信号不变       |

#### 绘制方法

1. 分解系统各环节
2. 写出各环节的传递函数
3. 绘制出各环节的方块图
4. 根据信号的传递方向将各方块图依次连接起来

#### 运算法则

| 运算类型 | 图示                                                                                                  | 公式                                                  | 说明                           |
| :------- | :---------------------------------------------------------------------------------------------------- | :---------------------------------------------------- | ------------------------------ |
| **串联** | ![串联](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510151549915.png) | $\displaystyle G(s)=\prod G_i(s)$                     | 各环节传递函数的乘积           |
| **并联** | ![并联](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161421549.png) | $\displaystyle G(s)=\sum  \pm G_i(s)$                 | 各环节传递函数的和             |
| **反馈** | ![反馈](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161424708.png) | $\displaystyle G(s)=\frac{G_1(s)}{1\pm G_1(s)G_2(s)}$ | 负反馈分母为加，正反馈分母为减 |

#### 方框图化简

·
方框图变换的方法 ß

| 序号 | 变换方式           | 原方块图                                                                                          | 等效方块图                                                                                        |
| :--- | :----------------- | :------------------------------------------------------------------------------------------------ | :------------------------------------------------------------------------------------------------ |
| 1    | 比较点变换         | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161438378.png) | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161439934.png) |
| 2    | 比较点分解         | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161440044.png) | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161440460.png) |
| 3    | 分支点前移         | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161441782.png) | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161441334.png) |
| 4    | 比较点后移         | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161443445.png) | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161444376.png) |
| 5    | 分支点前移         | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161444192.png) | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161445798.png) |
| 6    | 分支点后移         | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161507629.png) | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161619803.png) |
| 7    | 比较点与分支点交换 | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161619870.png) | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161620518.png) |
| 8    | 化为单位并联       | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161626631.png) | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161628965.png) |
| 9    | 化为单位反馈       | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161628968.png) | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161630089.png) |
| 10   | 分支点交换         | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161632905.png) | ![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161633706.png) |

### 信号流图

#### 基本组成

![信号流图举例](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202510161835215.png)

1.  **节点 (Node)**

    - 代表系统的变量
    - **输入节点（源点）**：只有输出支路的节点，代表系统的输入变量
    - **输出节点（阱点）**：只有输入支路的节点，代表系统的输出变量
    - **混合节点**：既有输入支路又有输出支路的节点

2.  **支路 (Branch)**
    - 连接两个节点的有向线段
    - **方向**：支路上的箭头表示信号的流向
    - **增益（传输）**：支路旁的代数式（传递函数）表示两个节点变量之间的函数关系信号流经该支路时，将被乘以该增益

#### 信号流图的基本概念

- **通路 (Path)**：从一个节点到另一个节点，沿着支路箭头方向经过一系列连续支路所构成的路径，且路径上任何节点只能经过一次
- **前向通路 (Forward Path)**：从**输入节点**到**输出节点**的一条**开通路**
- **回路 (Loop)**：起点和终点在同一节点的闭合通路
- **通路增益 (Path Gain)**：通路上所有支路增益的乘积
- **回路增益 (Loop Gain)**：回路上所有支路增益的乘积
- **互不接触回路 (Non-touching Loops)**：两个或多个回路之间没有任何公共节点

#### 信号流图的绘制

1. **确定变量**：根据系统的微分方程或代数方程，确定所有的输入、输出和中间变量作为图的节点
2. **排列节点**：按照信号的因果关系，将节点从左到右大致排列，输入节点在最左侧，输出节点在最右侧
3. **连接支路**：根据方程中变量之间的关系，用带箭头的支路连接相应的节点，并在支路上标注增益
4. **整理图形**：调整节点和支路布局，使图形清晰易读

#### 梅逊公式

梅森公式是求解信号流图总增益（即系统传递函数）的通用方法，尤其适用于结构复杂的系统

$$
P=\frac{1}{\Delta}\sum_{k=1}^{L}P_k\Delta_k
$$

- $P$：系统的总增益（传递函数）
- $P_k$：第 $k$ 条前向通路的增益
- $L$：前向通路的总数
- $\Delta$：系统的特征多项式

  $$
  \Delta=1-\sum_m L_{m_1}+\sum_m L_{m_2}-\sum_m L_{m_3}+\cdots
  $$

  - $L_{m_i}$：$i$ 个互不接触回路的增益乘积

- $\Delta_k$：与第 $k$ 条前向通路不接触的回路的特征多项式

## Matlab 和 Simulink

### Matlab 语言基础

#### 变量

- 变量名
  - 由字母、数字和下划线组成
  - 以字母开头
  - 区分大小写
  - 不得与 Matlab 保留字相同

#### 语句

- 赋值语句
  - `变量名=表达式`
- 函数调用语句
  - `[返回值列表]=函数名(参数列表)`
- 语句结尾
  - `...` ：续行符
  - `;` ：抑制输出
  - `,` ：不抑制输出
- 注释语句
  - `%` ：单行注释
  - `%{ %}` ：多行注释

#### 基本数学计算

##### 矩阵输入

输入矩阵

$$
A=
\begin{bmatrix}
1 & 2 & 3 \\
 4 & 5 & 6 \\
 7 & 8 & 9
\end{bmatrix}
$$

直接输入

```matlab
A=[1 2 3;4 5 6;7 8 9]
```

全零矩阵

```matlab
A=zeros(3) % 3x3 全零矩阵
A=zeros(2,3) % 2x3 全零矩阵
```

全一矩阵

```matlab
A=ones(3) % 3x3 全一矩阵
A=ones(2,3) % 2x3 全一矩阵
```

等

###### 矩阵运算

- 元素
  - 矩阵第 i 行：`A(i,:)`
  - 矩阵第 j 列：`A(:,j)`
- 子矩阵
  - `A(i:m,j:n)`

## 控制系统的时域分析

### 稳定性分析

#### 稳定的定义

##### 系统的性能

系统的输出为 $\displaystyle c(t)=c_s(t)+c_t(t)$

- 系统的动态特性 $\displaystyle c_t(t)$
  - 为系统达到**稳态**所需的时间
  - 包括了过渡期间输出偏离输入的程度
- 系统的稳态特性 $\displaystyle c_s(t)$
  - 输入信号只影响稳态部分
  - 稳态误差：系统达到稳态后输入与输出的偏差
- 系统的稳定性
  - 是系统正常运行的迁安题

##### 稳定的定义

如果一个线性定常系统在扰动作用消失后，能够恢复到原始的平衡状态，则称该系统是稳定的

即 $\displaystyle \exists T$，当 $t>T$ 时，输出偏差 $\displaystyle |\Delta c(t)|=|c(t)-c_0|\le\varepsilon$

#### 稳定的充要条件

- **闭环**传递函数

  $$
  \Phi(s)=\frac{C(s)}{R(s)}=\frac{b_ms^m+b_{m-1}s^{m-1}+\dots+b_0}{a_ns^n+a_{n-1}s^{n-1}+\dots+a_0}=\frac{B(s)}{D(s)}
  $$

  - $\displaystyle m\le n$
  - 令 $\displaystyle D(s)=0$ 得到系统的特征方程，记其根为 $\displaystyle p_1,p_2,\dots,p_n$，并且互不相同

- 系统的输出

  输入信号为 $\displaystyle \delta(t)$

  $$
  C(s)=\frac{B(s)}{D(s)}R(s)=\frac{B(s)}{D(s)}\mathcal{L}[\delta(t)]=\frac{B(s)}{D(s)}
  $$

  将其展开，设特征根为 $k$ 个实根，$r$ 对共轭复根，其中 $k+2r=n$，则有

  $$
  C(s)=\sum_{i=1}^{k}\frac{c_i}{s-p_i}+\sum_{j=1}^{r}\frac{\alpha_j s +\beta_j}{[s-(\sigma_j+j\omega_j)][s-p(\sigma_j-j\omega_j)]}
  $$

  对其做 Laplace 逆变换，得到理想脉冲作用下的输出

  $$
  c(t)=\sum_{i=1}^{k}c_ie^{p_it}+\sum_{j=1}^{r}e^{\sigma_j t}(\alpha_j \cos\omega_j t+\beta_j sin\omega_j t)
  $$

  > 注意，此形式仅适用于没有重根的情况，在有重根时部分系数带有 $t$ 的幂次

| 情况     | $p_i<0$，$\sigma_j<0$                                    | $p_i\le 0$，$\sigma_j\le 0$ 且 $p_i=0$ 或 $\sigma_j=0$ 时重根 | $p_i>0$ 或 $\sigma_j>0$，或 $p_i=0$，$\sigma_j=0$ 的根为复根 |
| :------- | :------------------------------------------------------- | :------------------------------------------------------------ | :----------------------------------------------------------- |
| 系统输出 | $c(t)\to 0$                                              | $c(t)$ 有界                                                   | $c(t)$ 无界                                                  |
| 输出形式 | $r=0$，趋于单调衰减<br>$r\neq 0$，趋于振荡衰减           | $r=0$，趋于常数<br>$r\neq 0$，趋于振荡常数                    | 趋于无穷大                                                   |
| 根的位置 | $r=0$，位于实轴负半轴<br>$r\neq 0$，位于左半复平面开平面 | $r=0$，位于实轴非正半轴<br>$r\neq 0$，位于左半复平面闭平面    | $r=0$，位于实轴非负半轴<br>$r\neq 0$，位于右半复平面闭平面   |

根据表可以得到线性系统稳定的充要条件

- **闭环系统**的特征方程所有根均具有复实部
  也可以说，闭环系统的特征方程所有根均位于复平面的左半平面内

稳定线性系统的输出性质

- 稳定性仅取决于系统自身的固有特性，与外界条件无关
- 稳定系统的脉冲应随 $t\to\infty$ 而衰减至零，不稳定系统则发散
- 稳定系统在增幅有界的输入信号下，输出增幅有界

#### 稳定性的判别方法

- 直接求根
  - 直接解微分方程：适用于低阶系统
  - 根轨迹法
    通过绘制闭环极值点随开环某参数变化的轨迹判断闭环稳定性
  - 利用计算机数值解或符号解
- 求特征根的范围
  - 劳斯判据
  - Nyquist 判据和 Bode 图
    - 根据开环频率特性判断闭环稳定性
    - 通过实验获取频率特性曲线，较为实用
- 李雅普诺夫判据
  非线性的任意阶系统
- 波波夫法
  非线性儒里叶型的时变系统
- 相平面法
  多用于一二阶非线性系统

主要研究劳斯判据

##### 劳斯判据

通过特征方程的系数来分析系统稳定性的一种代数判据

系统的特征方程为

$$
a_ns^n+a_{n-1}s^{n-1}+\dots+a_1s+a_0=0
$$

- 所有根均分布在左半平面的**必要条件**
  方程的所有系数均为正（PPT 表述存在问题，应该是同正同负？）

劳斯判据适用于实系数代数方程

###### 步骤

1. 将特征方程的系数按照规则排成两行
   - 第一行 $s^n$：$a_n,a_{n-2},a_{n-4},\dots$
   - 第二行 $s^{n-1}$：$a_{n-1},a_{n-3},a_{n-5},\dots$
2. 建立劳斯表

   - 从第三行开始，每个元素 $b_i$ 按下式计算，设其上一行的行首元素为 $c_n$，再上一行的行首元素为 $d_n$

   $$
   b_n =\frac{-\begin{vmatrix}d_n & d_{i+1}\\c_n & c_{i+1}\end{vmatrix}}{c_n}=\frac{c_n d_{i+1}-d_n c_{i+1}}{c_n}
   $$

   - 即前两行行首元素和 前两行 $b_i$ 右侧元素组成的行列式的负值除以前一行行首元素
   - 劳斯表应该有 $n+1$ 行，从 $s^n$ 行到 $s^0$ 行

3. 判别稳定性
   - 如果劳斯表第一列所有元素均为正，则系统稳定
   - 如果劳斯表第一列存在负元素，则系统不稳定，并且实部为正的根的个数等于第一列元素符号变化的次数

###### 特殊情况

这些情况会出现在建立劳斯表的过程中

1. 某行行首元素为 $0$，并且其他元素不为零
   - 可以用一个极小的正数代替 $0$，继续计算
   - 计算完成后，观察第一列符号变化的次数，如果 $0$ 上面项系数符号和 $0$ 下面项系数符号相反说明有一个符号变化
2. 某一行元素全部为 $0$
   - 可用全 $0$ 行放的一行构造辅助方程
   - 利用辅助方程对 $s$ 求导后得到的方程系数代替全零行的元素
   - 实际上，有了全 $0$ 行就说明系统是临界稳定的

### 稳态特征分析

#### 稳态误差

- 通常被称为稳态性能
- 是反映系统的控制精度的一种度量
- 与系统的结构、**输入信号的形式**有很大的关系
- 不稳定的系统无稳态误差

控制系统设计的任务是保证系统在稳定的前提下，尽量减小甚至消除稳态误差

任何一个稳定系统的误差信号 $e(t)$ 都可以看作是两个部分的叠加+

$$
e(t)=\mathcal{L}^{-1}[E(s)]=\mathcal{L}^{-1}{\Phi_e(s)R(s)}=e_{ts}(t)+e_{ss}(t)
$$

- e_ts(t)：暂态分量
  - 是误差信号中随时间推移而逐渐衰减、最终消失的部分
  - 反映了系统在响应初期的震荡、超调等过度过程
  - 当 $\displaystyle t\to\infty$ 时，$e_{ts}(t)\to 0$
- e_ss(t)：稳态分量
  - 是误差信号中在系统达到稳态后稳定保留的部分
  - 反映了系统在长期运行中的控制精度
  - 当 $\displaystyle t\to\infty$ 时，$e_{ss}(t)$ 保持恒定，这个值就是**稳态误差**

##### 误差的两种定义

- 输入端定义
  系统的输入信号与主反馈信号之差
- 输出端定义
  系统输出量实际值与期望值之差

#### Laplace 终值定理

如果一个函数值 $\displaystyle e(t)$ 当 $\displaystyle t\to\infty$ 时存在一个有限的极限值，那么这个值可以通过其 Laplace 变换 $E(s)$ 来计算

$$
e_{ss}=\lim_{t\to\infty}e(t)=\lim_{s\to 0}sE(s)
$$

当我们知道系统的传递函数和输入信号的 Laplace 变换时，可以通过计算 $sE(s)$ 在 $s\to 0$ 时的极限来求取稳态误差，这比先对 $E(s)$ 做逆变换再求极限要简单得多

在典型的反馈控制系统中，误差信号 $E(s)$ 与输入信号 $R(s)$ 之间和开环传递函数 $G(s)H(s)$ 之间的关系为

$$
E(s)=、R(s)-C(s)=R(s)-\frac{G(s)}{1+G(s)H(s)}\cdot H(s) R(s)=\frac{1}{1+G(s)H(s)}R(s)
$$

将其带入 Laplace 终值定理中，得到稳态误差的计算公式

$$
e_{ss}=\lim_{s\to 0}sE(s)=\lim_{s\to 0}\frac{s}{1+G(s)H(s)}R(s)
$$

#### 扰动下的稳态误差

![扰动输入方框图](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/%E6%89%B0%E5%8A%A8%E8%BE%93%E5%85%A5%E6%96%B9%E6%A1%86%E5%9B%BE.png)

这张方框图在研究扰动输入时等效为

![](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/%E6%89%B0%E5%8A%A8%E8%BE%93%E5%85%A5%E6%96%B9%E6%A1%86%E5%9B%BE%E7%AD%89%E6%95%88.drawio.png)

其误差对扰动的传递函数为

$$
\Phi_e(s)=\frac{E(s)}{N(s)}=\frac{-G_1(s)}{1+G_1(s)G_2(s)}
$$

当误差输入 $\displaystyle N(s)=\frac{1}{s}$ 时，稳态误差为

$$
e_{ss}=\lim_{s\to 0}sE(s)=\lim_{s\to 0}\frac{-G_2(s)H(s)}{1+G_1(s)GH_2(s)H_(s)}\cdot \frac{1}{s}=\frac{-G_2(0)H(0)}{1+G_1(0)G_2(0)H(0)}\approx -\frac{1}{G_1(0)}\ (G_1(0)G_2(0)\gg 1)
$$

#### 稳态误差与输入

- 稳态误差
  - 输入有关
  - 系统结构有关

三种典型输入信号

- 单位阶跃信号
  - $r(t)=1$
  - $R(s)=\frac{1}{s}$
- 单位速度信号
  - $r(t)=t$
  - $R(s)=\frac{1}{s^2}$
- 单位加速度信号
  - $r(t)=\frac{1}{2}t^2$
  - $R(s)=\frac{1}{s^3}$

#### 系统类型与稳态误差系数

开环传递函数（时间常数形式）

$$
G(s)H(s)=\frac{K(\tau'_1s+1)(\tau'_2s+1)\cdots(\tau_ms+1)}{s^N(T_1s+1)(T_2s+1)\cdots(T_{n-M}s+1)}
$$

- N：串联积分器的个数

根据系统中积分器的个数 $N$，将系统分为不同的类型

- N=0：零型系统
- N=1：一型系统
- N=2：二型系统

性质

- 根据已知的输入信号形式，可以判断是否存在稳态误差以及稳态误差的大小
- 系统阶数 $m,n$ 与系统类型 $N$ 无关，且不影响稳态误差的数值

$$
\lim_{s\to 0}G(s)H(s)=\lim_{s\to 0}\frac{K(\tau'_1s+1)(\tau'_2s+1)\cdots(\tau_ms+1)}{s^N(T_1s+1)(T_2s+1)\cdots(T_{n-M}s+1)}=\lim_{s\to 0}\frac{K}{s^N}
$$

#### 单位阶跃信号作用下的稳态误差

$$
e_{ss}=\lim_{s\to 0}sE(s)=\lim_{s\to 0}\frac{s}{1+G(s)H(s)}\cdot \frac{1}{s}=\lim_{s\to 0}\frac{1}{1+G(s)H(s)}=\frac{1}{1+K_p}=\begin{cases}\frac{1}{1+K},&N=0\\0,&N\ge 1\end{cases}
$$

稳态误差系数 $\displaystyle K_p=\lim_{s\to 0}G(s)H(s)$（位置误差系数）

- 0 型系统：$K_p=K$
  - 被称为有差系统
  - 误差大小与开环放大系数 $K$ 有关
  - 在稳定性允许的范围内，增大 $K$ 可减小稳态误差
- 1 型及以上系统：$K_p=\infty$

#### 单位速度信号作用下的稳态误差

$$
e_{ss}=\lim_{s\to 0}sE(s)=\lim_{s\to 0}\frac{s}{1+G(s)H(s)}\cdot \frac{1}{s^2}=\lim_{s\to 0}\frac{1}{s(1+G(s)H(s))}=\frac{1}{K_v}=\begin{cases}\infty,&N=0\\\frac{1}{K},&N=1\\0,&N\ge 2\end{cases}
$$

稳态误差系数 $\displaystyle K_v=\lim_{s\to 0}s G(s)H(s)$（速度误差系数）

- 0 型系统：$K_v=0$
- 1 型系统：$K_v=K$
  - 输出能跟踪输入速度信号的变化
  - 稳态误差大小与开环放大系数 $K$ 有关
- 2 型及以上系统：$K_v=\infty$

#### 单位加速度信号作用下的稳态误差

$$
e_{ss}=\lim_{s\to 0}sE(s)=\lim_{s\to 0}\frac{s}{1+G(s)H(s)}\cdot \frac{1}{s^3}=\lim_{s\to 0}\frac{1}{s^2(1+G(s)H(s))}=\frac{1}{K_a}=\begin{cases}\infty,&N=0\\\infty,&N=1\\\frac{1}{K},&N=2\\0,&N\ge 3\end{cases}
$$

稳态误差系数 $\displaystyle K_a=\lim_{s\to 0}s^2 G(s)H(s)$（加速度误差系数）

- 0 型系统：$K_a=0$
- 1 型系统：$K_a=0$
- 2 型系统：$K_a=K$
  - 输出能跟踪输入加速度信号的变化
  - 稳态误差大小与开环放大系数 $K$ 有关
- 3 型及以上系统：$K_a=\infty$

#### 总结

| 系统型号 | 误差 $K_p$ | $K_v$    | 系数 $K_a$ | 阶跃输入 $r(t)=u(t)$ | 速度输入 $r(t)=t$ | 加速度输入 $r(t)=\frac{1}{2}t^2$ |
| :------- | :--------- | :------- | :--------- | :------------------- | :---------------- | :------------------------------- |
| 0 型     | $K$        | $0$      | $0$        | $\frac{1}{1+K}$      | $\infty$          | $\infty$                         |
| 1 型     | $\infty$   | $K$      | $0$        | $0$                  | $\frac{1}{K}$     | $\infty$                         |
| 2 型     | $\infty$   | $\infty$ | $K$        | $0$                  | $0$               | $\frac{1}{K}$                    |

#### 减小稳态误差的方法

- 提高开环增益 $K$
  - 增大 $K$ 可减小稳态误差，但会影响系统稳定性
- 提高开环传递函数中串联积分环节的个数 $N$
  - 增加积分环节可提高系统类型，从而减小稳态误差
  - 但会影响系统的动态性能，可能引起系统振荡
  - $N$ 一般不超过 $2$
- 补偿法

### 动态特性分析

#### 概念

控制系统的输出为

$$
c(t)=c_s(t)+c_t(t)
$$

- $\displaystyle c_s(t)$：稳态部分
- $\displaystyle c_t(t)$

动态相应也叫瞬态响应

- 对应系统从初始状态到接近稳定状态的相应
  - 通常使用零初始状态条件下的单位阶跃响应的动态特性衡量
  - 输入只会影响稳态分量
  - 系统分析的准确度取决于数学模型描述的真实程度
  - 希望系统有很快的响应速度
    - 即在控制信号的作用下，系统的输出能很快地随控制信号变化
  - 与稳定性的关系
    - 动态响应对稳定系统才有意义
    - 不稳定系统的动态响应是发散的

#### 动态性能指标

![动态性能指标合集](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202511101440702.png)

- 延迟时间 $t_d$
  - 输出达到稳态值的 $50\%$ 所需的时间
- 上升时间 $t_r$
  - 有振荡系统输出从 $0$ 到首次达到稳态值的时间
  - 无振荡系统输出从 $10\%$ 到 $90\%$ 稳态值的时间
- 峰值时间 $t_p$
  - 输出首次达到峰值所需的时间
- 超调量 $\sigma_p$
  - $\displaystyle \sigma_p=\frac{c(t_p)-c_\infty}{c_\infty}\times 100 \%$
- 调整时间 $t_s$
  - 输出进入并保持在稳态值的预定范围 $\Delta$ 内所需的时间
- 误差范围 $\Delta$
  - 一般取稳态值的 $\pm 2\%$ 或 $\pm 5\%$

#### 一阶系统动态特性

![一阶系统](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/%E4%B8%80%E9%98%B6%E7%B3%BB%E7%BB%9F.png)

一阶系统闭环传递函数为

$$
\frac{C(s)}{R(s)}=\frac{1}{1+Ts}
$$

##### 单位阶跃响应

$$
C(s)=\frac{1}{Ts+1}\cdot \frac{1}{s}=\frac{1}{s}-\frac{T}{Ts+1}
$$

对其做 Laplace 逆变换，得到单位阶跃响应输出

$$
c(t)=1-e^{-\frac{t}{T}}
$$

- 无振荡、按照指数规律单调上升
- 延迟时间 $t_d=0.69T$
- 上升时间 $t_r=2.2T$
- 调整时间
  - $t_s=4T$（$\Delta=\pm 2\%$）
  - $t_s=3T$（$\Delta=\pm 5\%$）
- 特征根
  - $s=-\frac{1}{T}$
  - 为 $\displaystyle -\frac{\mathrm{d}c(t)}{\mathrm{d}t}|_{t=0}$，可以通过实验得到

##### 单位脉冲响应

$$
C(s)=\frac{1}{1+Ts}\cdot 1=\frac{1}{Ts+1}
$$

对其做 Laplace 逆变换，得到单位脉冲响应输出

$$
c(t)=\frac{1}{T}e^{-\frac{t}{T}}
$$

##### 单位速度响应

$$
C(s)=\frac{1}{1+Ts}\cdot \frac{1}{s^2}=\frac{1}{s^2}-\frac{T}{s}+\frac{T^2}{Ts+1}
$$

对其做 Laplace 逆变换，得到单位速度响应输出

$$
c(t)=t-T+Te^{-\frac{t}{T}}
$$

- 稳态分量 $\displaystyle c_s(t)=t-T$
- 稳态误差 $e_{ss}=T$
- 瞬态分量 $\displaystyle c_t(t)=Te^{-\frac{t}{T}}$

##### 单位加速度响应

$$
C(s)=\frac{1}{1+Ts}\cdot \frac{1}{s^3}=\frac{1}{s^3}-\frac{T}{s^2}+\frac{T^2}{s}-\frac{T^3}{Ts+1}
$$

对其做 Laplace 逆变换，得到单位加速度响应输出

$$
c(t)=\frac{1}{2}t^2-Tt+T^2-T^2e^{-\frac{t}{T}}
$$

#### 二阶系统动态特性

![二阶系统](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/%E4%BA%8C%E9%98%B6%E7%B3%BB%E7%BB%9F.png)

二阶系统闭环传递函数为

$$
\Phi(S)=\frac{C(s)}{R(s)}=\frac{K}{Ts^2+s+K}=\frac{\frac{K}{T}}{s^2+\frac{1}{T}s+\frac{K}{T}}
$$

记

- 无阻尼（自然）振荡角频率 $\displaystyle \omega_n=\sqrt{\frac{K}{T}}$
- 阻尼比 $\displaystyle \xi=\frac{1}{2\sqrt{K T}}$

传递函数可写为

$$
\Phi(S)=\frac{\omega_n^2}{s^2+2\xi \omega_n s+\omega_n^2}
$$

按照阻尼比 $\xi$ 的不同，二阶系统可分为三种类型

- 欠阻尼系统：$0<\xi<1$
- 临界阻尼系统：$\xi=1$
- 过阻尼系统：$\xi>1$

##### 二阶系统的特征方程

$$
s^2+2\xi \omega_n s+\omega_n^2=0
$$

- 两个特征根

  $$
  s_{1,2}=-\xi \omega_n \pm \omega_n \sqrt{\xi^2-1}
  $$

![根的分布情况](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202511101730974.png)

##### 欠阻尼

有一对共轭复根

$$
s_{1,2}=-\xi\omega_n\pm j\omega_n\sqrt{1-\xi^2}=-\sigma\pm j\omega_d
$$

- 衰减系数 $\displaystyle \sigma=\xi \omega_n$
- 阻尼振荡角频率 $\displaystyle \omega_d=\omega_n \sqrt{1-\xi^2}$
- 记 $\cos\theta=\xi$，则 $\sin\theta=\sqrt{1-\xi^2}$，$\displaystyle \tan\theta=\frac{\sqrt{1-\xi^2}}{\xi}$

以阶跃响应为例

$$
\begin{aligned}
  C(s)&=\frac{\omega_n^2}{s^2+2\xi \omega_n s+\omega_n^2}\cdot\frac{1}{s}\\
      &=\frac{1}{s}-\frac{s+\xi\omega_n}{(s+\xi\omega_n^2)+\omega_d^2}-\frac{\xi\omega_n}{(s+\xi\omega_n)^2+\omega_d^2}
\end{aligned}
$$

对其做 Laplace 逆变换，得到单位阶跃响应输出

$$
c(t)=1-\frac{e^{-\xi \omega_n t}}{\sqrt{1-\xi^2}}\sin(\omega_d t+\theta)
$$

为振荡衰减曲线，振荡频率为 $\displaystyle\omega_d$

包络线为

$$
1 \pm \frac{1}{\sqrt{1-\xi^2}} e^{-\xi\omega_n t}
$$

- 时间常数 $\xi\omega_n$
- 衰减系数 $\frac{1}{\xi\omega_n}$

###### 阻尼比系数 $\xi$

- 阻尼比系数小
  - 震荡强
  - 上升时间短
  - 超调量大
  - 调整时间长
  - 稳态误差增加
- 阻尼比系数大
  - 上升时间长

所以一般选取 $0.5\le \xi \le 0.8$

最佳的阻尼比为 $0.707$

###### 峰值时间 $t_p$

$$
\frac{\mathrm{d}c(t)}{\mathrm{d}t}\vert_{t=t_p}=0
$$

整理得到

$$
\omega_dt_p=0,\pi,2\pi,3\pi,\dots
$$

取第一个正根，得到

$$
t_p=\frac{\pi}{\omega_d}=\frac{\pi}{\omega_n \sqrt{1-\xi^2}}
$$

峰值时间 $t_p$ 与极点虚部 $\omega_d$ 成反比，并且当 $\xi$ 一定时，极点离实轴越远，$t_p$ 越小

###### 超调量 $\sigma_p$

$$
\sigma_p=c(t_p)-1=e^{-\frac{\xi \pi}{\sqrt{1-\xi^2}}}\times 100\%
$$

超调量 $\sigma_p$ 仅与阻尼比 $\xi$ 有关

- 阻尼比 $\xi$ 越大，超调量 $\sigma_p$ 越小
- 当 $\xi\to 0$ 时，$\sigma_p\to 100\%$
- 当 $\xi\ge 0.69$ 时，$\sigma_p\le 5\%$

###### 上升时间 $t_r$

$$
c(t_r)=1-\frac{e^{-\xi \omega_n t_r}}{\sqrt{1-\xi^2}}\sin(\omega_d t_r+\theta)=1
$$

$$
t_r=\frac{\pi-\theta}{\omega_d}=\frac{\pi-\arccos\xi}{\omega_n \sqrt{1-\xi^2}}
$$

- 当 $\xi$ 一定，$\omega_n$ 越大，$t_r$ 越小
- 当 $\omega_n$ 一定，$\xi$ 越大，$t_r$ 越大

###### 调整时间 $t_s$

定义为从系统开始响应起，直到响应曲线 $c(t)$ 进入并永久保持在终值 $1$ 的一个小的误差带 $\Delta$ （例如 $5\%$ 或 $3\%$）之内所需的最短时间

以包络线来近似研究调整时间问题

$$
\left\vert 1-c(s)\right\vert \approx \frac{e^{-\xi\omega_n t_s}}{\sqrt{1-\xi^2}}=\Delta
$$

$$
t_s=-\frac{\ln(\Delta \sqrt{1-\xi^2})}{\xi \omega_n}
$$

- $\Delta=5\%$ 时，$t_s\approx \frac{3}{\xi \omega_n}$
- $\Delta=2\%$ 时，$t_s\approx \frac{4}{\xi \omega_n}$

调整时间 $t_s$ 与极点实部 $\sigma=\xi \omega_n$ 成反比，并且当 $\xi$ 一定时，极点离虚轴越远，$t_s$ 越小

超调量 $\sigma_p$ 的值由 $\xi$ 决定，若 $\xi$ 不变，通过调整 $\omega_n$ 可以做到在不影响 $\sigma_p$ 的前提下，减小 $t_s$，加快系统的响应速度

###### 总结

二阶系统单位阶跃响应

$$
c(t)=1-\frac{e^{-\xi \omega_n t}}{\sqrt{1-\xi^2}}\sin(\omega_d t+\theta)s
$$

- 上升时间

  $$
  t_r=\frac{\pi-\arccos\xi}{\omega_n \sqrt{1-\xi^2}}
  $$

- 峰值时间

  $$
  t_p=\frac{\pi}{\omega_n \sqrt{1-\xi^2}}
  $$

- 超调量

  $$
  \sigma_p=e^{-\frac{\xi \pi}{\sqrt{1-\xi^2}}}\times 100\%
  $$

- 调整时间

  $$
  t_s=-\frac{\ln(\Delta \sqrt{1-\xi^2})}{\xi \omega_n}
  $$

##### 临界阻尼

特征根为两个相等的实根

$$
s_{1,2}=-\omega_n
$$

$$
C(s)=\frac{\omega_n^2}{(s+\omega_n)^2}\cdot \frac{1}{s}=\frac{1}{s}-\frac{1}{s+\omega_n}-\frac{\omega_n}{(s+\omega_n)^2}
$$

对其做 Laplace 逆变换，得到单位阶跃响应输出

$$
c(t)=1-(1+\omega_n t)e^{-\omega_n t}
$$

##### 过阻尼

特征根为两个不等的实根

$$
s_{1,2}=-\xi \omega_n \pm \omega_n \sqrt{\xi^2-1}
$$

$$
c(s)=\frac{\omega_n^2}{s(s+\frac{1}{T_1})(s+\frac{1}{T_2})}
$$

$$
c(t)=1+\frac{1}{\frac{T_2}{T_1}-1}e^{-\frac{t}{T_1}}-\frac{1}{\frac{T_2}{T_1}-1}e^{-\frac{t}{T_2}}
$$

单调增加的曲线，没有超调和振荡，调节时间较长，系统反应迟缓

###### 无阻尼

特征根为两个共轭虚根

$$
s_{1,2}=\pm j \omega_n
$$

$$
c(t)=1-\cos \omega_n t
$$

为振荡频率为 $\displaystyle \omega_n$ 的等幅振荡曲线，不能达到稳态

#### 高阶系统的动态响应

高阶系统指的是三阶以上的系统

使用计算机仿真或者近似降阶为二阶系统来处理

控制系统的闭环传递函数为

$$
\frac{C(s)}{R(s)}=\frac{b_ms^m+b_{m-1}s^{m-1}+\dots+b_1 s+b_0}{a_ns^n+a_{n-1}s^{n-1}+\dots+a_1 s+a_0}
$$

其阶跃响应为

$$
C(s)=\frac{K\prod(s+z_i)}{\prod(s+p_j)\prod(s^2+2\xi_k \omega_{nk}s+\omega_{nk}^2)}\cdot \frac{1}{s}
$$

$$
\begin{aligned}
  c(t)&=a_0+\sum_{j=1}^q a_je^{-p_jt}+\sum_{i=1}^r e^-\xi_k\omega_kt(B_k\cos\omega_kt\sqrt{1-\xi_k^2}+C_k\sin\omega_kt\sqrt{1-\xi_k^2})\\
      &=a_0+\sum_{J=1}^q a_je^{-p_jt}+\sum_{i=1}^r D_ke^{-\xi_k\omega_kt}\sin(\omega_kt\sqrt{1-\xi_k^2}+\varphi_k)
\end{aligned}
$$

- **主导极点**
  - 距离虚轴最近的极点，比其它极点到虚轴的距离小 5 倍以上，且附近无零点
  - 系统的动态响应将由主导极点决定
  - 高阶系统的主导极点通常为一对共轭复极点
- **附加零点、极点**
  - 零点或极点距离虚轴的距离是主导极点的两倍以上
  - 对动态响应的影响可以忽略不计
- **偶极子**

  - 同一位置或相距很近的闭环零极点
    - 它们之间的距离是它们到主导极点距离的 $\frac{1}{10}$ 或更小
  - 对系统的动态响应影响很小

- **响应曲线**
  - 由小振荡曲线、大振荡曲线、指数曲线叠加而成
  - 形状取决于闭环零点：各分量幅值大小
- **动态响应**
  - 稳态分量的类型取决于输入函数的极点
  - 动态分量取决于系统闭环传递函数的极点
  - 类型取决于闭环极点：指数型、正弦振荡型

## 控制系统的复域分析

### 根轨迹法的概念

根轨迹法是通过绘制闭环极点随开环某参数变化的轨迹来判断闭环系统稳定性的一种图解方法，其参变量为系统增益 $K_1$

描述的是当 $K_1$ 从 $0$ 变化到 $\infty$ 时，闭环系统极点在复平面上的运动轨迹

- 常规根轨迹：$0\le K_1 <+\infty$ 时的根轨迹，简称为根轨迹
- 补根轨迹（余根轨迹）：$-\infty<K_1<0$ 时的根轨迹
- 完全根轨迹（全根轨迹）：$-\infty<K_1<+\infty$ 时的根轨迹

### 根轨迹的幅相条件

闭环系统的特征方程为

$$
1+G(s)H(s)=0
$$

其中

$$
G(s)H(s)=\frac{K_1\prod_{i=1}^m (s+z_i)}{\prod_{j=1}^n (s+p_j)}\quad (n\ge m)
$$

根轨迹上的点均满足幅角条件和幅值条件，满足幅角条件的点都在根轨迹上

- 通过寻找满足幅角条件的所有 $s$ 点，由这些点组成根轨迹
- 根据幅值条件计算出对应点的 $K_1$ 值

#### 幅角条件

$$
\angle G(s)H(s)=\sum_{i=1}^m\angle (s+z_i)-\sum_{j=1}^n \angle (s+p_j)=\pi\pm 2k\pi,\quad k=0,1,2,\dots
$$

#### 幅值条件

$$
\vert G(s)H(s)\vert =\frac{K_1\prod_{i=1}^m \vert s+z_i\vert}{\prod_{j=1}^n \vert s+p_j\vert}=1
$$

### 根轨迹图的绘制

主要有两种方法

1. 试探法
   1. 找到尽量多的满足相角条件的点
   2. 连接成光滑曲线
   3. 用幅值条件计算根轨迹上点的 $K_1$ 值
2. 规则法
   1. 计算出 $K_1=0$ 时的特征根（开环极点）和 $K_1\to \infty$ 时的特征根（开环零点或无穷远）
   2. 根据绘制法大致画出 $0<K_1<\infty$ 时的根轨迹草图
   3. 使用幅角条件修正重要部分

#### 根轨迹绘制的十条规则

##### 根轨迹的起点和终点

- $n$ 个起点（$K_1=0$）：开环极点
- $n$ 个终点（$K_1\to \infty$）：开环零点
  - $m$ 个有限零点
  - $n-m$ 个无穷远零点

当 $K_1$ 从 $0$ 增加到 $\infty$ 时，根轨迹从开环极点出发，终止于开环零点

##### 根轨迹的分支数

- 一条完整的根轨迹为一条分支
- 根轨迹的分支数等于开环极点数 $n$

##### 根轨迹对称性

- 根轨迹对称于实轴

##### 根轨迹的渐近线

渐近线有 $n-m$ 条

- 渐近线与实轴交点（渐近点）

  $$
  -\lambda=-\frac{\sum_{j=1}^n p_j-\sum_{i=1}^m z_i}{n-m}
  $$

- 渐近线与实轴的夹角

  $$
  \theta_k=\frac{\pi\pm 2k\pi}{n-m},\quad k=0,1,2,\ldots
  $$

##### 根轨迹在实轴上的分布

实轴上凡是有根轨迹的线段，其右侧（包含右端）的开环零点、极点个数之和为奇数

##### 根轨迹的分离点

分离点

- 为特征方程的重根点
- 不一定在实轴上

分离点满足

$$
\frac{\mathrm{d}G_1(s)H_1(s)}{\mathrm{d}s}=0
$$

其中

$$
G_1(s)G_2(s)=\frac{G(s)H(s)}{K_1}
$$

分离点处的分离的根轨迹切线斜率为

$$
\frac{1}{N}(\pi+2k\pi),\quad k=0,1,2,\ldots ,N-1
$$

几个经验法则

1. 如果实轴上开环极点间存在根轨迹，则存在分离点
2. 如果实轴上开环零点间存在根轨迹，则存在会合点
3. 如果实轴上开环极点与开环零点间存在根轨迹
   - 要么既存在分离点又存在会合点
   - 要么二者都不存在

分离点的必要条件等价表达式

$$
\frac{\mathrm{d}}{\mathrm{d}s}[G_1(s)H_1(s)]=0
$$

- $\displaystyle \frac{\mathrm{d}K_1}{\mathrm{d}s}=0$
- $\displaystyle \sum_{i=1}^{m}\frac{1}{s+z_i}= \sum_{i=1}^{n}\frac{1}{s+p_i}$

##### 根轨迹入射角和出射角

出射角（或入射角）：根轨迹离开复极点（或终止复零点）处切线的倾角

- 若根轨迹一个分支离开复极点 $-p_a$ 的出射角为 $\theta_a$，则

  $$
  \theta_a=\pi-\left[\sum_{i=1,i\ne a}^{n}\angle(-p_a+p_i)-\sum_{j=1}^{m}\angle(-p_a+z_j)\right]+2k\pi,\quad k=0,1,2,\ldots
  $$

- 若根轨迹一个分支终止于复零点 $-z_b$ 的入射角为 $\phi_b$，则

  $$
  \phi_b=\pi+\left[\sum_{i=1}^{n}\angle(-z_b+p_i)-\sum_{j=1,j\ne b}^{m}\angle(-z_b+z_j)\right]+2k\pi,\quad k=0,1,2,\ldots
  $$

![入射角例子](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202511221835529.png)

其中

$$
\theta_a=\pi+2k\pi+\varphi_1-(\theta_1+\theta_2+\theta_3)
$$

##### 根轨迹与虚轴的焦点

根轨迹与虚轴交点纵坐标为

$$
1+G(j\omega)H(j\omega)=0
$$

的解 $\omega$

此时系统处于临界稳定状态

##### 根轨迹的走向

当 $n-m\ge 2$ 时，随着 $K_1$ 的增加，一些根轨迹分支向左方移动，另一些根轨迹分支向右方移动

$$
G(s)H(s)=\frac{K_1(s+z_1)\cdots(s+z_m)}{(s+p_1)\cdots(s+p_n)}=\frac{K_1(s^m+\sum_{i=1}^mz_is^{m-1}+\cdots\cdots+\prod_{i=1}^mz_m)}{s^n+\sum_{j=1}^np_js^{n-1}+\cdots\cdots+\prod_{j=1}^np_j}
$$

$$
1+G(s)H(s)=s^n+\sum_{j=1}^n p_j s^{n-1}+\cdots+\prod_{j=1}^np_j+K_1s^m+K_1\sum_{i=1}^m z_i s^{m-1}+\cdots+K_1\prod_{i=1}^mz_i
$$

- 当满足 $m-n\ge 2$ 时，上式中 $s^{n-1}$ 项没有同类项可以合并，通常将其称为极点的重心
- 当 $K_1$ 保持不变时，极点的重心保持不变，为 $\displaystyle - \sum_{j=1}^{n}\frac{p_i}{n}$

##### 根轨迹上 $K_1$ 的计算

$$
K_1=\frac{\prod_{j=1}^n \vert s+p_j\vert}{\prod_{i=1}^m \vert s+z_i\vert}=\frac{G_1(s_1)H_1(s_1)\text{极点至}s_1\text{向量长度的乘积}}{G_1(s_1)H_1(s_1)\text{零点至}s_1\text{向量长度的乘积}}
$$

##### 总结

| 序  | 内容               | 规则                                                                                                                                                                                                                                                             |
| :-- | :----------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 1   | 起点<br>终点       | 起始于开环极点<br>终止于开环零点（包括无限零点）                                                                                                                                                                                                                 |
| 2   | 分支数             | 等于开环传递函数的极点数（ $n \ge m$ ）                                                                                                                                                                                                                          |
| 3   | 对称性             | 对称于实轴                                                                                                                                                                                                                                                       |
| 4   | 渐近线             | 相交于实轴上的同一点：坐标为 $\sigma_a = \frac{\sum_{i=1}^n p_i - \sum_{j=1}^m z_j}{n - m}$，倾角为 $\varphi = \frac{\pi \pm 2k\pi}{n - m}$                                                                                                                      |
| 5   | 实轴上分布         | 实轴上的根轨迹，其右边开环传递函数的零点、极点数之和必为奇数                                                                                                                                                                                                     |
| 6   | 分离点 /<br>会合点 | 实轴上的分离（会合）点（必要条件）<br> $\frac{\mathrm{d}[G_1(s)H_1(s)]}{\mathrm{d}s} = 0$ 或 $\frac{\mathrm{d}K_1}{\mathrm{d}s} = 0$                                                                                                                             |
| 7   | 出射角<br>入射角   | 复极点处的出射角：<br> $\theta_a = \pi \pm 2k\pi + \sum_{i=1}^m \angle(P_a - Z_i) - \sum_{j=1, j \neq a}^n \angle(P_a - P_j)$ <br>复零点处的入射角：<br> $\varphi_b = \pi \pm 2k\pi + \sum_{j=1}^n \angle(Z_b - P_j) - \sum_{i=1, i \neq b}^m \angle(Z_b - Z_i)$ |
| 8   | 虚轴交点           | 满足特征方程 $1 + G(j\omega)H(j\omega) = 0$ 的 $\omega$ 值或由劳斯阵列求得（及 $K_1$ 响应的值）                                                                                                                                                                  |
| 9   | 走向               | 当 $n - m \ge 2$ ， $K_1 \to \infty$ 时，一些轨迹向右，则另一些将向左                                                                                                                                                                                            |
| 10  | $K_1$ 计算         | 根轨迹上任一点处的 $K_1$ ：<br> $\vert K_1 \vert = \frac{1}{\vert G_1(s_1)H_1(s_1) \vert} = \frac{G_1(s_1)H_1(s_1)\text{极点至}s_1\text{向量长度的乘积}}{G_1(s_1)H_1(s_1)\text{零点至}s_1\text{向量长度的乘积}}$                                                 |

### 系统性能分析

#### 根轨迹分析系统性能

控制系统的性功能由闭环零点、极点位置决定

- 定性分析
  - 稳定性分析
- 定量分析
  - 暂态响应分析
  - 定量计算性能指标

#### 稳定性分析

主要通过根轨迹图上点的分布来判断系统的稳定性

- 稳定系统
  - 所有闭环极点均在复平面左半部
- 临界稳定系统
  - 有闭环极点在虚轴上，其余闭环极点在复平面左半部
- 不稳定系统
  - 有闭环极点在复平面右半部

#### 稳态性能分析

一般来说，开环增益 $K_1$ 越大，系统的稳态误差越小

但是随着 $K_1$ 的增大，根轨迹向右移动，可能导致系统不稳定，并且阻尼比 $\xi$ 变小，振荡变强，超调量增大，动态性能变差

#### 动态性能分析

通过根轨迹图可以分析系统的动态性能

- 实部 $\sigma$ 决定收敛速度

  - 实部离虚轴越远，系统调节时间 $t_s$ 越短，响应越快

  $$
  t_s \approx \frac{4}{\vert\sigma\vert} \text{或} t_s \approx \frac{3}{\vert\sigma\vert}
  $$

- 虚部 $\omega_d$ 决定振荡频率

  - 离实轴越远，振荡频率越高

- 与负实轴夹角 $\theta$ 决定阻尼比 $\xi$

  - 夹角越远离 $\frac{\pi}{2}$，阻尼比越大，超调量越小

  $$
  \xi=\cos\theta
  $$

#### 闭环零极点与系统性能

##### 零极点的功能

- 闭环极点分布
  - 决定动态响应类型
    - 极点为实数
      - 单调的指数响应，不振荡
    - 极点为复数
      - 振荡响应
    - 极点在右半平面
      - 系统不稳定
- 闭环零点分布
  - 决定瞬态响应曲线的形态和指标

##### 零极点对系统动态性能的影响及其化简

- 主导极点
  - 决定系统的动态性能
  - 主导极点一般为一对共轭复极点
  - 主导极点位置越靠近虚轴，系统响应越慢
  - 过于远离虚轴的主导极点忽略不计（$e^{-\sigma t}$ 衰减过快）
- 偶极子
  - 对系统动态性能影响较小，可忽略不计

##### 增加零极点的影响

- 闭环实数零点
  - 减小系统阻尼比，超调量增大，峰值时间提前
- 闭环实数极点
  - 较小系统超调量，峰值时间延后
- 两个复极点
  - 暂态过程主要决定于离虚轴较近的极点

##### 复极点的几何意义

当闭环极点是共轭复数 $s=-\sigma\pm j\omega_d$ 时

- 阻尼比 $\xi=\frac{\sigma}{\sqrt{\sigma^2+\omega_d^2}}=\cos\theta$
- 极点到原点的距离 $\omega_n =\sqrt{\sigma^2+\omega_d^2}$，也是自然频率
- 若控制 $\omega_n$ 不变，改变 $\xi$，则极点在以原点为中心，$\omega_n$ 为半径的圆弧上移动
- 若控制 $\xi$ 不变，改变 $\omega_n$，则极点在以原点为中心，倾角为 $\theta$ 的直线上移动，随着 $\omega_n$ 的增大，极点沿着矢量方向延伸，系统响应速度加快
- $\sigma=\xi \omega_n$ 决定系统响应速度

## 控制系统的频域分析

### 频率特性

当一个线性系统输入一个正弦信号 $r(t) = A \sin(\omega t)$ 时，其稳态输出 $c(t)$ 必定是与输入信号**同频率**的正弦信号，但其幅值和相位会发生变化，即 $c(t) = B \sin(\omega t + \phi)$

系统的频率特性 $G(j\omega)$ 定义为在任意角频率 $\omega$ 下，系统稳态输出信号的复数表示（相量）与输入信号的复数表示（相量）之比

### Nyquest 图

- **坐标轴**: 横轴为实部 $\text{Re}[G(j\omega)H(j\omega)]$，纵轴为虚部 $\text{Im}[G(j\omega)H(j\omega)]$
- **曲线**: 当角频率 $\omega$ 从 $0$ 变化到 $+\infty$ 时，复数量 $G(j\omega)H(j\omega)$ 在复平面上描绘出的完整轨迹

### Bode 图

#### Bode 图的构成

- 对数幅频曲线
  - **纵坐标**: 采用对数单位**分贝 (dB)** 来表示幅值，计算公式为 $L(\omega) = 20\log_{10}\left\vert G(j\omega) \right\vert$
  - **横坐标**: 采用对数刻度表示角频率 $\omega$ （常用 $\log_{10}\omega$）
  - 幅频曲线可以使用直线段折线来近似
- 对数相频曲线
  - **纵坐标**: 采用线性刻度的角度（**°**）来表示相位 $\phi(\omega) = \angle G(j\omega)$
  - **横坐标**: 同样采用对数刻度的角频率 $\omega$

#### 典型环节的 Bode 图

##### 放大环节 $G(j\omega)=K$

- 幅频特性

  $$
  L(\omega)=20\log_{10}\vert K\vert
  $$

  - 幅值为 $20\lg K$ 分贝

- 相频特性

  $$
  \phi(\omega)=0^\circ
  $$

![放大环节 Bode 图](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202512171712892.png)

##### 积分环节 $G(j\omega)=\frac{1}{j\omega}$

- 幅频特性

  $$
  L(\omega)=20\log_{10}\left\vert \frac{1}{j\omega}\right\vert =-20\log_{10}\omega
  $$

  - 斜率为 $-20$ dB/十倍频程，即 $20 \text{ dB/dec}$
  - 经过横轴 $\omega=1$ 处，斜率为 $-20 \text{ dB/dec}$ 的直线

- 相频特性

  $$
  \phi(\omega)=\angle \frac{1}{j\omega}=-90^\circ
  $$

![积分环节的 Bode 图](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202512171715257.png)

##### 微分环节 $G(j\omega)=j\omega$

- 幅频特性

  $$
  L(\omega)=20\log_{10}\left\vert j\omega\right\vert =20\log_{10}\omega
  $$

  - 斜率为 $20$ dB/十倍频程，即 $20 \text{ dB/dec}$
  - 经过横轴 $\omega=1$ 处，斜率为 $20 \text{ dB/dec}$ 的直线

- 相频特性

  $$
  \phi(\omega)=\angle j\omega=90^\circ
  $$

![微分环节的 Bode 图](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202512171716048.png)

##### 惯性环节 $G(j\omega)=\frac{1}{1+j\omega T}$

- 幅频特性

  $$
  L(\omega)=20\log_{10}\left\vert \frac{1}{1+j\omega T}\right\vert =-10\log_{10}(1+(\omega T)^2)
  $$

  - 低频段 $(\omega \ll \frac{1}{T})$：幅值近似为 $0$ dB
  - 高频段 $(\omega \gg \frac{1}{T})$：幅值近似为 $-20\log_{10}\omega T$，斜率为 $-20$ dB/十倍频程
  - 截止频率 $\omega_c=\frac{1}{T}$ 处，幅值为 $-3$ dB

- 相频特性

  $$
  \phi(\omega)=\angle \frac{1}{1+j\omega T}=-\arctan(\omega T)
  $$

  - 低频段 $(\omega \ll \frac{1}{T})$：相位近似为 $0^\circ$
  - 高频段 $(\omega \gg \frac{1}{T})$：相位近似为 $-90^\circ$
  - 截止频率 $\omega_c=\frac{1}{T}$ 处，相位为 $-45^\circ$

![惯性环节的 Bode 图](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202512171721719.png)

##### 一阶微分环节 $G(j\omega)=\frac{j\omega T}{1+j\omega T}$

- 幅频特性

  $$
  L(\omega)=20\log_{10}\left\vert \frac{j\omega T}{1+j\omega T}\right\vert =20\log_{10}\omega T -10\log_{10}(1+(\omega T)^2)
  $$

  - 低频段 $(\omega \ll \frac{1}{T})$：幅值近似为 $20\log_{10}\omega T$，斜率为 $20$ dB/十倍频程
  - 高频段 $(\omega \gg \frac{1}{T})$：幅值近似为 $0$ dB
  - 截止频率 $\omega_c=\frac{1}{T}$ 处，幅值为 $-3$ dB

- 相频特性

  $$
  \phi(\omega)=\angle \frac{j\omega T}{1+j\omega T}=90^\circ -\arctan(\omega T)
  $$

  - 低频段 $(\omega \ll \frac{1}{T})$：相位近似为 $0^\circ$
  - 高频段 $(\omega \gg \frac{1}{T})$：相位近似为 $90^\circ -90^\circ=0^\circ$
  - 截止频率 $\omega_c=\frac{1}{T}$ 处，相位为 $45^\circ$

![一阶微分环节的 Bode 图](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202512171728308.png)

##### 震荡环节 $G(j\omega)=\frac{1}{T^2 j\omega^2+2\xi T j\omega +1}$

- 幅频特性

  $$
  L(\omega)=20\log_{10}\left\vert \frac{1}{T^2 j\omega^2+2\xi T j\omega +1}\right\vert =-10\log_{10}[(1-T^2\omega^2)^2+(2\xi T \omega)^2]
  $$

  - 低频段 $(\omega \ll \frac{1}{T})$：幅值近似为 $0$ dB
  - 高频段 $(\omega \gg \frac{1}{T})$：幅值近似为 $-40\log_{10}\omega T$，斜率为 $-40$ dB/十倍频程
  - 截止频率 $\omega_n=\frac{1}{T}$ 处，幅值为 $-20\log_{10}(2\xi)$ dB

- 相频特性

  $$
  \phi(\omega)=\angle \frac{1}{T^2 j\omega^2+2\xi T j\omega +1}=-\arctan\frac{2\xi T \omega}{1-T^2\omega^2}
  $$

  - 低频段 $(\omega \ll \frac{1}{T})$：相位近似为 $0^\circ$
  - 高频段 $(\omega \gg \frac{1}{T})$：相位近似为 $-180^\circ$
  - 截止频率 $\omega_n=\frac{1}{T}$ 处，相位为 $-90^\circ$

![震荡环节的 Bode 图](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202512171733334.png)

#### 绘制 Bode 图的方法

##### 直接计算法

将各个基本环节的 Bode 图叠加起来，得到系统的 Bode 图

##### 近似折线叠加法

1. 将系统开环传递函数 $G(s)H(s)$ 分解为各个基本环节的乘积形式，并且整理为**时间常数形式**
2. 求出所有典型环节的转折频率，并在图上标注出来
3. 在 $\omega=1$ 量出幅值 $20\lg K$
4. 在该点做一条斜率为 $-20 N$ 的直线，直到第一个转折频率
5. 每个转折处改变一次渐近线的斜率
   1. 每遇到一个一阶惯性环节，斜率改变 $-20$ dB/十倍频程
   2. 每遇到一个一阶微分环节，斜率改变 $+20$ dB/十倍频程
   3. 每遇到一个二阶振荡环节，斜率改变 $-40$ dB/十倍频程
6. 根据各个转折频率处的实际幅值，修正曲线（可选）

#### 最小相位系统

系统**开环传递函数**中，没有位于 $S$ 右半平面的零点和极点，没有纯时间延迟环节的系统

### 奈氏判据

使用开环频率特性判断闭环系统的稳定性

特点

- 可以判断系统的稳定发行
  - 求出右半复平面内闭环系统特征根的数目
- 可以计算稳定系统的稳定程度，即相对稳定性
  - 可以用来计算改善系统稳定程度的方案

#### 辐角定理

$F(s)$ 是 $s$ 的单值有理函数，在 $s$ 平面上的任意闭合路径 $\Tau_s$ 包含了 $F(s)$ 的 $P$ 个极点和 $Z$ 个零点，当 $s$ 沿着 $\Tau_s$ 逆时针方向运动一周时，$F(s)$ 在复平面上所围绕原点的次数 $N$ 满足

$$
N=Z-P
$$

顺时针为正方向

#### Nyquist 路径

$$
s=-j\infty \to -j0 \to +j0 \to +j\infty \to -j\infty
$$

- 沿着顺时针方向包围了整个 $s$ 右半平面
- 不能经过 $F(s)$ 的任何零点、极点
  - 若 $F(s)$ 在虚轴上有极点，则在 Nyquist 路径上绕过该极点一个小半径的半圆，按照逆时针方向绕过这些极点

![Nyquest 路径](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202512221449207.png)

#### 稳定性分析

1. 目标
   判断闭环传递函数 $\Phi(s)$ 在 $s$ 右半平面有无极点
2. 转化
   问题转化为判断闭环特征方程 $F(s)$ 在 $s$ 右半平面有无零点
   若能够求出 $Z$ 并且 $Z=0$，则系统稳定；否则系统不稳定
3. 工具
   引入辐角原理 $N=Z-P$
4. 求解 $P$
   通过分析已知的开环传递函数 $G(s)H(s)$，求出 $F(s)$ 在 $s$ 右半平面的极点个数 $P$
5. 求解 $N$
   $N$ 为当 $s$ 沿着包围整 $s$ 右半平面的 Nyquist 路径 $\Tau_s$ 逆时针运动一周时，$F(s)$ 在复平面上所围绕原点的次数
   等价于开环传递函数 $G(s)H(s)$ 的 Nyquist 图绕点 $(-1,0j)$ 的次数
6. 求解 $Z$

   $$
   Z=N+P
   $$

#### 简易方法

利用 Nyquist 图的对称性，只判断 $\omega$ 从 $0$ 变化到 $+\infty$ 时其穿越行为来判断整体环绕情况

##### 穿越的定义

- 对象
  Nyquist 图与负实轴上 $(-1,j0)$ 左侧的相交情况
- 分类
  - 正穿越
    - 方向
      从上往下穿过
    - 物理意义
      在穿越点附近，系统的相位正在增加，滞后减小
    - 使用 $N_+$ 来表示正穿越总次数
  - 负穿越
    - 方向
      从下往上穿过
    - 物理意义
      在穿越点附近，系统的相位正在减小，滞后增加
    - 使用 $N_-$ 来表示负穿越总次数

如果起始点或种植点恰好在 $(-1,j0)$ 左侧，则记为 $\frac{1}{2}$ 次穿越

##### 计算方法

完整 Nyquist 图绕点 $(-1,j0)$ 的次数 $N$

$$
N=N_+-N_-
$$

##### 闭环系统稳定的充要条件

当 $\omega$ 从 $0$ 变化到 $+\infty$ 时，Nyquist 图与负实轴上 $(-1,j0)$ 左侧的穿越次数满足

$$
N_+-N_-=\frac{P}{2}
$$

#### Nyquist 图与 Bode 图之间的关系

##### 幅频特性的对应

- 单位圆 $\Leftrightarrow$ $0\text{ dB}$ 直线

  - 在 Nyquist 图上，模长为 $1$ 的点组成单位圆

    $$
    L(\omega)=20\log_{10}\vert G(j\omega)H(j\omega)\vert =0\text{ dB}
    $$

- 单位圆以内的点 $\Leftrightarrow$ $0\text{ dB}$ 以下区域
- 单位圆以外的点 $\Leftrightarrow$ $0\text{ dB}$ 以上区域

##### 相频特性的对应

- 负实轴 $\Leftrightarrow$ $180^\circ$ 相位线

  - 在 Nyquist 图上，负实轴上的点对应相位为 $\pm 180^\circ$ 的点

    $$
    \phi(\omega)=\angle G(j\omega)H(j\omega)=\pm 180^\circ
    $$

##### 穿越行为的等价

- Nyquist 图中的穿越
  - 穿过临界点 $(-1,j0)$ 左侧的负实轴
  - 条件
    1. 相角为 $-180^\circ$
    2. 幅值大于 $1$
- Bode 图中的等价穿越
  - 条件
    1. 相频曲线 $\phi(\omega)$ 穿过了 $-180^\circ$ 相位线
    2. 在同一频率点，幅频曲线 $L(\omega)$ 位于 $0\text{ dB}$ 直线以上
  - 结论
    - Nyquist 图中的每一次穿越行为，都对应着 Bode 图中幅频曲线位于 $0\text{ dB}$ 直线以上时，相频曲线穿过 $-180^\circ$ 相位线
- 穿越方向的对应
  - 正穿越
    - 相频曲线 $\phi(\omega)$ 由下向上穿过 $-180^\circ$ 相位线
  - 负穿越
    - 相频曲线 $\phi(\omega)$ 由上向下穿过 $-180^\circ$ 相位线

#### 基于 Bode 图的 Nyquist 判据

当 $\omega$ 从 $0$ 变化到 $+\infty$ 时，在开环对数幅频特性 $L(\omega)\ge 0$ 的频段内

$$
N_+-N_-=\frac{P}{2}
$$

#### 稳定裕度

- 闭环系统的稳定程度
  - 开环频率特性 $G(j\omega)H(j\omega)$ 离临界点 $(-1,j0)$ 的远近程度
  - 离 $(-1,j0)$ 越远，系统越稳定
- 增益剪切频率 $\omega_c$

  - 开环频率特性 $G(j\omega)H(j\omega)$ 的幅值等于 $1$ 时的频率

    $$
    \vert G(j\omega_c)H(j\omega_c)\vert =1
    $$

- 相位裕量 $\gamma$

  - 在控制系统的增益剪切频率 $\omega_c$ 上，使得闭环系统达到临界稳定状态所需要附加的相移（超前或滞后）

    $$
    \gamma=180^\circ +\phi(\omega_c)
    $$

- 相位剪切频率 $\omega_g$

  - 开环频率特性 $G(j\omega)H(j\omega)$ 的相位等于 $-180^\circ$ 时的频率

    $$
    \phi(\omega_g)=-180^\circ
    $$

- 增益裕量 $K_g$

  - 在系统的相位剪切频率 $\omega_g$ 上，开环频率特性的倒数

  $$
  K_g=\frac{1}{\vert G(j\omega_g)H(j\omega_g)\vert}
  $$

  $$
  K_g(dB)=20\log_{10}K_g=-20\log_{10}\vert G(j\omega_g)H(j\omega_g)\vert\text{ dB}
  $$

  - $K_g>1$ 或 $K_g(dB)>0$，系统稳定

### 稳态分析

| 系统<br>型号 | 误差<br> $K_p$ |  $K_v$   | 系数<br> $K_a$ | 单位阶跃<br>输入<br> $r(t)=u(t)$ | 单位速度<br>输入<br> $r(t)=t$ | 单位加速度<br>输入<br> $r(t)=t²$ |
| :----------: | :------------: | :------: | :------------: | :------------------------------: | :---------------------------: | :------------------------------: |
|   **0 型**   |      $K$       |   $0$    |      $0$       |         $\frac{1}{1+K}$          |           $\infty$            |             $\infty$             |
|   **I 型**   |    $\infty$    |   $K$    |      $0$       |               $0$                |         $\frac{1}{K}$         |             $\infty$             |
|  **II 型**   |    $\infty$    | $\infty$ |      $K$       |               $0$                |              $0$              |          $\frac{1}{K}$           |

#### 基于 Bode 图的稳态误差分析

##### $0$ 型系统开环频率特性

$$
G(j\omega)=\frac{K}{j\omega T+1}
$$

低频段 $\omega \to 0$

- 幅值

  $$
  L(\omega)=20\log_{10}\left\vert \frac{K}{j\omega T+1}\right\vert \approx 20\log_{10}K_P
  $$

##### I 型系统开环频率特性

$$
G(j\omega)=\frac{K}{j\omega (j\omega T+1)}
$$

低频段，即第一个转折频率之前

低频段幅频对数曲线或其延长线

- 与 $\omega = 1$ 的直线交点处对应的幅值为 $20\lg K_v$
- 与 $0$ dB 直线交点处对应的频率为 $\omega_v=K_v$

##### II 型系统开环频率特性

$$
G(j\omega)=\frac{K}{(j\omega)^2 (j\omega T+1)}
$$

低频段

- 幅频对数曲线或其延长线
  - 与 $\omega = 1$ 的直线交点处对应的幅值为 $20\lg K_a$
  - 与 $0$ dB 直线交点处对应的频率为 $\omega_a=\sqrt{K_a}$

### 动态分析

#### 动态性能指标

- 时域指标
  - 超调量 $M_p$
  - 调节时间 $t_s$
- 开环频域指标
  - 相位裕度 $\gamma$
  - 增益剪切频率 $\omega_c$
- 闭环频域指标

##### 开环频域指标

对于二阶系统，其开环传递函数为

$$
G(s)H(s)=\frac{\omega_n^2}{s(s+2\xi \omega_n)}
$$

###### 增益剪切频率 $\omega_c$

$$
\vert G(j\omega_c)H(j\omega_c)\vert =\frac{\omega_n^2}{\omega_c \sqrt{\omega_c^2+(2\xi \omega_n)^2}}=1
$$

$$
\omega_c=\omega_n\sqrt{\sqrt{1+4\xi^4}-2\xi^2}
$$

###### 相位裕度 $\gamma$

$$
\gamma = 180^\circ +\angle G(j\omega_c)H(j\omega_c)=\arctan\frac{2\xi \omega_n}{\omega_c}=\arctan\frac{2\xi}{\sqrt{\sqrt{1+4\xi^4}-2\xi^2}}
$$

当 $0<\gamma <60^\circ$ 时，近似为直线关系

$$
\gamma=100\xi
$$

###### 超调量 $\sigma_p$

$$
\sigma_p=e^{\frac{-\pi \xi}{\sqrt{1-\xi^2}}}\times 100\%
$$

- 当 $\xi$ 增大时，$\sigma_p$ 减小 -一般取 $30^\circ\le \gamma\le 60^\circ$
- 当 $\gamma=65^\circ$
  - $\xi=0.707$
  - $\sigma_p=4.3\%$

###### 调节时间 $t_s$

取 $t_s$ 为系统响应进入并保持在最终值的 $5\%$ 以内所需的时间

$$
\left\{
   \begin{aligned}
    t_s & \approx \frac{3}{\xi \omega_n} \\
    \omega_n & =\omega_c \frac{1}{\sqrt{\sqrt{1+4\xi^4}-2\xi^2}}
   \end{aligned}
\right.
$$

则

$$
t_s\omega_c = \frac{3\sqrt{\sqrt{1+4\xi^4}-2\xi^2}}{\xi}=\frac{6}{\tan\gamma}
$$

###### 高阶系统的开环频域指标

$$
\sigma_p\approx 0.16+0.4\left(\frac{1}{\sin\gamma}- \right)\quad(0^\circ <\gamma <90^\circ)
$$

$$
t_s\approx\frac{K\pi}{\omega_c}(s),\quad K=2+1.5\left(\frac{1}{\sin\gamma}-1\right)+2.5\left(\frac{1}{\sin\gamma}-1\right)^2
$$

##### 闭环频域指标

- 零频幅值 $M_0$
  - $\omega=0$ 时闭环幅值
- 谐振峰值 $M_r$
  - 闭环幅值的最大值
- 谐振频率 $\omega_r$
  - 闭环幅值的最大值所对应的频率
- 系统带宽 $\omega_b$
  - 闭环幅值减小到 $0.707M_0$ 时的频率
  - $0\le\omega\le\
  - omega_b$ 被称为系统带宽
- 剪切率
  - $M_(\omega)$ 在 $\omega_b$ 处的斜率
  - 斜率越大，抗干扰能力越强
- 闭环系统的频域动态指标 $M_r$ 和 $\omega_b$ 与时域动态指标 $\sigma_p$ 和 $t_s$ 之间存在一定的关系
  - $M_r$ 越大，$\sigma_p$ 越大
  - $\omega_b$ 越大，$t_s$ 越小

###### 一阶系统

$$
G(s)=\frac{1}{Ts}
$$

$$
\Phi(s)=\frac{1}{Ts+1}
$$

$$
\Phi(j\omega)=\frac{1}{1+j\omega T}
$$

$$
\left\{
   \begin{aligned}
      &M(\omega)=\frac{1}{\sqrt{1+(\omega T)^2}}\\
      &\alpha(\omega)=-\arctan(\omega T)
   \end{aligned}
\right.
$$

- 零频幅值 $M_0=1$
- 谐振峰值 $M_r=1$
- 谐振频率 $\omega_r=0$
- 系统带宽 $\omega_b=\frac{1}{T}$

###### 二阶系统

$$
\Phi(s)=\frac{\omega_n^2}{s^2+2\xi \omega_n s+\omega_n^2}
$$

$$
\Phi(j\omega)=\frac{\omega_n^2}{-\omega^2+j2\xi \omega_n \omega +\omega_n^2}
$$

$$
\left\{
   \begin{aligned}
      &M(\omega)=\frac{\omega_n^2}{\sqrt{(\omega_n^2-\omega^2)^2+(2\xi \omega_n \omega)^2}}=\frac{1}{\sqrt{\left[1-\frac{\omega^2}{\omega_n^2}\right]^2+\left[2\xi\frac{\omega}{\omega_n}\right]^2}}\\
      &\alpha(\omega)=-\arctan\frac{2\xi \omega_n \omega}{\omega_n^2-\omega^2}=-\arctan\frac{2\xi \frac{\omega}{\omega_n}}{1-(\frac{\omega}{\omega_n})^2}
   \end{aligned}
\right.
$$

- 谐振频率 $\omega_r=\omega_n \sqrt{1-2\xi^2}\quad(0<\xi<\frac{1}{\sqrt{2}})$
- 谐振峰值 $M_r=\frac{1}{2\xi \sqrt{1-\xi^2}}\quad(0<\xi<\frac{1}{\sqrt{2}})$
- 带宽

  $$
  M(\omega_b)=\frac{1}{\sqrt{2}}M_0=\frac{1}{\sqrt{2}}\Rightarrow \omega_b=\omega_n \sqrt{1-2\xi^2+\sqrt{4\xi^4-4\xi^2+2}}
  $$

  并且 $\displaystyle w_bt_s \approx \frac{3}{\xi}\sqrt{1-2\xi^2+\sqrt{4\xi^4-4\xi^2+2}}$

###### 高阶系统

经验公式

$$
M_r=\frac{1}{\sin\gamma}\quad (35^\circ \le \gamma \le 90^\circ)
$$

$$
\sigma_P =0.16 +0.4(M_r-1)\quad (1\le M_r \le 1.8)
$$

$$
t_s=\frac{K\pi}{\omega_c},\quad K=2+1.5(M_r-1)+2.5(M_r-1)^2
$$

##### 闭环幅值、相位与开环幅值、相位的关系

我们设

$$
\left\{
   \begin{aligned}
      &\Phi(j\omega)=\frac{G(j\omega)}{1+G(j\omega)}=M(\omega)e^{j\alpha(\omega)}\\
      &G(j\omega)=A(\omega)e^{j\varphi(\omega)}
   \end{aligned}
\right.
$$

$$
Me^{j\alpha(\omega)}=\left[1+\frac{1}{A(\omega)e^{j\varphi(\omega)}}\right]^{-1}=\left[1+\frac{e^{-j\varphi(\omega)}}{\vert A\vert}\right]^{-1}=\left[\left(1+\frac{\cos\varphi(\omega)}{\vert A\vert}\right)-j\frac{\sin\varphi(\omega)}{\vert A\vert}\right]^{-1}
$$

$$
\left\{
   \begin{aligned}
      &M(\omega)=\frac{1}{\sqrt{1+\frac{2\cos\varphi}{\vert A \vert}+\frac{1}{\vert A\vert^2}}}\\
      &\alpha(\omega)=\arctan\frac{\frac{\sin\varphi}{\vert A\vert}}{1+\frac{\cos\varphi}{\vert A\vert}}=\arctan\frac{\sin\varphi}{\vert A\vert +\cos\varphi}
   \end{aligned}
\right.
$$

##### Nichols 图

将 Bode 图合二为一

![Nichols 图](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202512282208767.png)

- 令 $M=const$，得到等 $M$ 曲线
- 令 $\alpha=const$，得到等 $\alpha$ 曲线

## 自动控制系统的校正

### 概述

- 系统校正的概念
  - 在系统结构和参数已知的基础上，引入辅助装置（校正装置）来改善系统的性能，使其满足预定的稳态和动态指标
- 校正装置分类：
  - 按结构分
    - 串联校正
    - 反馈校正
    - 前馈校正
    - 复合校正
  - 按有无放大能力分
    - 有源校正
    - 无源校正

#### 串联校正

![串联校正](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202512221717032.png)

- 特点：从设计到具体实现均较为简单，最为常用
- 适用：系统稳态特性已经满足，暂态性能较差
- 问题：对参数变化的敏感性较强
- 通常将串联校正装置安置在前向通道的前端
  - 可以减少校正装置的输出功率，降低成本和功耗
    - 因为前部信号的功率较小

#### 反馈校正

![反馈校正](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202512282344081.png)

- 特点
  - 一般没有附加放大器，所需要的元件比串联校正少
    - 信号从高功率点传向低功率点
  - 校正后的性能主要取决于校正装置
    - 与被哦反馈校正装置所包围的系统固有部分特性无关
- 优点：可以一直系统的参数波动以及非线性因素对系统性能的影响
- 缺点：设计相对较为复杂

#### 前馈校正

![两种前馈矫正](https://raw.githubusercontent.com/dcldyhb/Freshman-Notes-Image-Host/main/202512290124120.png)
